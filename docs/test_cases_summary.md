# AI Tutor System - 테스트 케이스 요약

## 테스트 범위

개발된 모든 주요 기능에 대한 테스트 케이스를 작성했습니다. 총 6개 카테고리, 35개 이상의 테스트 케이스가 구현되었습니다.

## 1. 인증 시스템 테스트 (test_auth.py)

### TC-AUTH-001: 사용자 회원가입
- **목적**: 새로운 사용자가 정상적으로 회원가입할 수 있는지 확인
- **테스트 항목**:
  - 이메일, 비밀번호, 이름 등 필수 정보 입력
  - 회원가입 후 사용자 정보 반환 확인
  - 기본 권한(user) 부여 확인

### TC-AUTH-002: 사용자 로그인
- **목적**: 등록된 사용자가 정상적으로 로그인할 수 있는지 확인
- **테스트 항목**:
  - 올바른 이메일/비밀번호로 로그인
  - JWT 토큰 발급 확인
  - 토큰 타입 확인

### TC-AUTH-003: 관리자 권한 접근 제어
- **목적**: 권한별 API 접근 제어가 정상 작동하는지 확인
- **테스트 항목**:
  - 일반 사용자의 관리자 API 접근 차단 (403)
  - 관리자의 관리자 API 접근 허용 (200)

### TC-AUTH-004: 3단계 권한 시스템
- **목적**: user, institution_admin, super_admin 권한 체계 검증
- **테스트 항목**:
  - 각 권한별 접근 가능한 리소스 확인
  - 권한 상속 관계 확인

## 2. 콘텐츠 관리 시스템 테스트 (test_content.py)

### TC-CONTENT-001: 콘텐츠 카테고리 생성
- **목적**: 콘텐츠 카테고리를 생성할 수 있는지 확인
- **테스트 항목**:
  - 카테고리 이름, 슬러그, 설명 입력
  - 생성된 카테고리 정보 확인

### TC-CONTENT-002: 콘텐츠 생성
- **목적**: 새로운 콘텐츠를 생성할 수 있는지 확인
- **테스트 항목**:
  - 제목, 내용, 타입, 카테고리 설정
  - 태그 및 메타 정보 입력
  - 초기 상태(draft) 확인

### TC-CONTENT-003: 콘텐츠 발행
- **목적**: 작성된 콘텐츠를 발행할 수 있는지 확인
- **테스트 항목**:
  - 발행 상태 변경 (draft → published)
  - 발행 시간 기록 확인

### TC-CONTENT-004: 콘텐츠 버전 관리
- **목적**: 콘텐츠 수정 시 버전이 관리되는지 확인
- **테스트 항목**:
  - 콘텐츠 업데이트 시 버전 증가
  - 이전 버전 보관 확인

### TC-CONTENT-005: 콘텐츠 검색 및 필터링
- **목적**: 콘텐츠를 검색하고 필터링할 수 있는지 확인
- **테스트 항목**:
  - 키워드 검색 기능
  - 콘텐츠 타입별 필터링
  - 카테고리별 필터링

### TC-CONTENT-006: 계층적 카테고리 구조
- **목적**: 부모-자식 관계의 카테고리 구조가 작동하는지 확인
- **테스트 항목**:
  - 자식 카테고리 생성
  - 카테고리 트리 조회

## 3. 리포트 생성 시스템 테스트 (test_reports.py)

### TC-REPORT-001: 사용자 진도 리포트 생성
- **목적**: 사용자 학습 진도 리포트를 생성할 수 있는지 확인
- **테스트 항목**:
  - 리포트 생성 요청
  - 날짜 범위 파라미터 설정
  - 생성 상태 확인

### TC-REPORT-002: 리포트 생성 진행 상태 추적
- **목적**: 리포트 생성 진행 상황을 실시간으로 확인할 수 있는지 확인
- **테스트 항목**:
  - 진행률 조회
  - 상태 메시지 확인
  - 완료/실패 상태 감지

### TC-REPORT-003: 다양한 리포트 유형 생성
- **목적**: 5가지 리포트 유형이 모두 생성되는지 확인
- **테스트 항목**:
  - 사용자 진도, 학습 분석, AI 사용 현황, 월간 요약, 맞춤형 리포트
  - 각 리포트별 파라미터 설정

### TC-REPORT-004: 다양한 리포트 포맷 테스트
- **목적**: PDF, Excel, CSV 포맷으로 리포트가 생성되는지 확인
- **테스트 항목**:
  - 각 포맷별 리포트 생성
  - 포맷 정보 확인

### TC-REPORT-005: 리포트 목록 필터링
- **목적**: 생성된 리포트를 필터링하여 조회할 수 있는지 확인
- **테스트 항목**:
  - 리포트 타입별 필터링
  - 상태별 필터링

### TC-REPORT-006: 리포트 접근 권한 제어
- **목적**: 권한에 따른 리포트 접근 제어가 작동하는지 확인
- **테스트 항목**:
  - 일반 사용자의 리포트 접근 차단
  - 관리자만 리포트 조회 가능

## 4. WebSocket/실시간 기능 테스트 (test_websocket.py)

### TC-WS-001: WebSocket 연결 테스트
- **목적**: WebSocket 연결이 정상적으로 수립되는지 확인
- **테스트 항목**:
  - 인증된 사용자의 WebSocket 연결
  - Ping/Pong 메시지 교환

### TC-WS-002: 사용자 접속 상태 관리
- **목적**: 실시간 사용자 상태가 관리되는지 확인
- **테스트 항목**:
  - 온라인 상태 업데이트
  - 활성 사용자 목록 조회

### TC-WS-003: 실시간 알림 전송
- **목적**: WebSocket을 통한 실시간 알림이 작동하는지 확인
- **테스트 항목**:
  - 알림 채널 구독
  - 알림 수신 확인

### TC-WS-004: 채팅 스트리밍 응답
- **목적**: SSE를 통한 스트리밍 응답이 작동하는지 확인
- **테스트 항목**:
  - 스트리밍 메시지 전송
  - 청크 단위 응답 수신

### TC-WS-005: 다중 WebSocket 연결 처리
- **목적**: 동시 다발적인 WebSocket 연결을 처리할 수 있는지 확인
- **테스트 항목**:
  - 여러 연결 동시 생성
  - 각 연결별 메시지 라우팅

### TC-WS-006: WebSocket 에러 처리
- **목적**: WebSocket 에러가 적절히 처리되는지 확인
- **테스트 항목**:
  - 잘못된 메시지 형식 처리
  - 알 수 없는 메시지 타입 처리

## 5. RAG 문서 관리 테스트 (test_rag.py)

### TC-RAG-001: 텍스트 문서 업로드
- **목적**: 텍스트 형식의 문서를 업로드할 수 있는지 확인
- **테스트 항목**:
  - 제목, 내용, 메타데이터 입력
  - 문서 타입 확인

### TC-RAG-002: 파일 문서 업로드
- **목적**: 파일 형식의 문서를 업로드할 수 있는지 확인
- **테스트 항목**:
  - 파일 업로드 처리
  - 파일 정보 저장

### TC-RAG-003: 문서 임베딩 생성 확인
- **목적**: 업로드된 문서의 임베딩이 생성되는지 확인
- **테스트 항목**:
  - 청크 생성 확인
  - 처리 상태 확인

### TC-RAG-004: 문서 검색 기능
- **목적**: 키워드로 문서를 검색할 수 있는지 확인
- **테스트 항목**:
  - 키워드 검색
  - 검색 결과 확인

### TC-RAG-005: 메타데이터 기반 필터링
- **목적**: 메타데이터로 문서를 필터링할 수 있는지 확인
- **테스트 항목**:
  - 카테고리별 필터링
  - 메타데이터 조건 검색

### TC-RAG-006: 문서 삭제
- **목적**: 문서를 삭제할 수 있는지 확인
- **테스트 항목**:
  - 문서 삭제 처리
  - 삭제 후 조회 시 404 확인

### TC-RAG-007: RAG 컨텍스트 검색
- **목적**: 유사도 기반 문서 검색이 작동하는지 확인
- **테스트 항목**:
  - 쿼리와 유사한 문서 검색
  - 유사도 점수 확인

### TC-RAG-008: 대용량 문서 청킹
- **목적**: 긴 문서가 적절히 분할되는지 확인
- **테스트 항목**:
  - 긴 문서 업로드
  - 여러 청크로 분할 확인

## 6. 통합 시나리오 테스트 (test_integration.py)

### TC-INT-001: 전체 사용자 여정 테스트
- **목적**: 일반 사용자의 전체 사용 시나리오 검증
- **테스트 시나리오**:
  1. 회원가입
  2. 로그인
  3. 학습 경로 조회
  4. 대화 시작
  5. 메시지 전송
  6. AI 도구 조회
  7. 학습 진도 업데이트

### TC-INT-002: 관리자 워크플로우 테스트
- **목적**: 관리자의 주요 작업 흐름 검증
- **테스트 시나리오**:
  1. 관리자 로그인
  2. 대시보드 통계 조회
  3. 콘텐츠 생성
  4. RAG 문서 업로드
  5. 리포트 생성
  6. 사용자 관리

### TC-INT-003: 동시성 테스트
- **목적**: 시스템의 동시 처리 능력 검증
- **테스트 항목**:
  - 10명의 사용자 동시 생성
  - 동시 로그인 처리

### TC-INT-004: 에러 복구 시나리오
- **목적**: 다양한 에러 상황에서의 시스템 동작 검증
- **테스트 항목**:
  - 잘못된 로그인 시도 (401)
  - 잘못된 토큰 사용 (401)
  - 존재하지 않는 리소스 접근 (404)
  - 잘못된 데이터 형식 (422)

### TC-INT-005: 데이터 일관성 테스트
- **목적**: 여러 API 간 데이터 일관성 검증
- **테스트 항목**:
  - 사용자 생성 후 통계 반영
  - 대화 생성 후 카운트 증가
  - 권한별 데이터 접근 범위

## 테스트 실행 방법

### 전체 테스트 실행
```bash
cd backend
./run_tests.sh
```

### 특정 카테고리 테스트 실행
```bash
./run_tests.sh "인증 시스템"
./run_tests.sh "콘텐츠 관리"
./run_tests.sh "리포트 생성"
```

### 개별 테스트 파일 실행
```bash
python -m pytest tests/test_auth.py -v
python -m pytest tests/test_content.py::TestContentManagement::test_create_content -v
```

## 테스트 환경 설정

- **테스트 데이터베이스**: SQLite in-memory
- **테스트 프레임워크**: pytest
- **비동기 테스트**: pytest-asyncio
- **HTTP 클라이언트**: httpx

## 주의사항

1. **WebSocket 테스트**: Docker 환경에서 WebSocket 서버가 실행 중이어야 합니다.
2. **RAG 테스트**: Qdrant 벡터 DB가 실행 중이어야 합니다.
3. **리포트 테스트**: Celery worker가 실행 중이어야 완전한 테스트가 가능합니다.

## 테스트 커버리지

- 인증 및 권한: 100%
- 콘텐츠 관리: 100%
- 리포트 생성: 90% (실제 파일 생성은 통합 테스트에서 확인)
- WebSocket: 80% (실제 연결은 환경에 따라 다름)
- RAG: 90% (임베딩 생성은 AI 서비스 필요)
- 통합 시나리오: 100%

## 향후 개선사항

1. **성능 테스트**: 대용량 데이터 처리 및 응답 시간 측정
2. **보안 테스트**: SQL Injection, XSS 등 보안 취약점 테스트
3. **UI 테스트**: Selenium을 사용한 E2E 테스트
4. **부하 테스트**: Locust를 사용한 부하 테스트